

  XCMProxy Testnet - Configuration Check

ğŸ”— Connecting to XCMProxy at: 0xf935e063b2108cc064bB356107ac01Dc90f96652
âœ… Successfully connected to contract

    Contract Deployment
      âœ” should be deployed at correct address
      âœ” should respond to function calls (53ms)
    Role Configuration
   Owner: 0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
      âœ” should have owner configured (55ms)
   Operator: 0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
      âœ” should have operator configured (46ms)
    Integration Configuration
   NFPM Contract: 0xFAA10aBB2F3C0eE3c6c51C67bA870D08A5e457C3
      âœ” should have NFPM contract set (38ms)
   Quoter Contract: 0x0fcf84e13e4551a12b6bfF7e3504e45C1a1CC1eF
      âœ” should have Quoter contract set (46ms)
   SwapRouter Contract: 0x78d99c9EED0C6B31Ef961F5372b6f2000E7a912a
      âœ” should have SwapRouter contract set (46ms)
    XCM Configuration
   XTokens Precompile: 0x0000000000000000000000000000000000000804
      âœ” should check XTokens precompile configuration (45ms)
   XCM Transactor Precompile: 0x0000000000000000000000000000000000000806
      âœ” should check XCM Transactor precompile configuration
   Asset Hub Para ID: 1000
      âœ” should check Asset Hub parachain ID
   Default Dest Weight: 6000000000
      âœ” should check default destination weight (63ms)
   XCM Config Frozen: false
      âœ” should check if XCM config is frozen
   Trusted XCM Caller: 0x67E5293e374219C515bD9838B23C792C555e51D4
      âœ” should check trusted XCM caller
    Operating Parameters
   Paused: false
      âœ” should check pause status (38ms)
   Test Mode: true
   âœ… Test mode enabled - XCM calls will be skipped
      âœ” should check test mode status (39ms)
   Default Slippage: 100 bps (1.00%)
      âœ” should check default slippage (85ms)
   Position Counter: 12 positions created
      âœ” should check position counter (52ms)
    Health Check Summary

ğŸ“Š XCMProxy Configuration Summary:
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   Owner:          0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
   Operator:       0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   NFPM:           âœ… 0xFAA10aBB2F3C0eE3c6c51C67bA870D08A5e457C3
   Quoter:         âœ… 0x0fcf84e13e4551a12b6bfF7e3504e45C1a1CC1eF
   SwapRouter:     âœ… 0x78d99c9EED0C6B31Ef961F5372b6f2000E7a912a
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   XTokens:        âœ… 0x0000000000000000000000000000000000000804
   Asset Hub ID:   âœ… 1000
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   Status:         âœ… Active
   Test Mode:      âœ… Enabled
   Slippage:       100 bps (1.00%)
   Positions:      12 created
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

   âœ… CONTRACT IS FULLY CONFIGURED AND READY

      âœ” should display configuration summary (525ms)

  XCMProxy Testnet - Receive Assets

âœ… Connected to XCMProxy at: 0xf935e063b2108cc064bB356107ac01Dc90f96652
âœ… Network: moonbase
âœ… Operator: 0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
âœ… Supported Token: 0xdeb2336eA55d25B6286761CDdA17F5B5636cB84A
âœ… Pool ID: 0x85a000207D69042E8B075fCe43B6F28dfCE228b2

    Asset Reception - Basic Flow
      âœ” should receive assets and create pending position (2743ms)
      âœ” should reject unsupported tokens (110ms)
      âœ” should reject zero amount (106ms)
      âœ” should reject zero user address (85ms)
      âœ” should reject duplicate position IDs (78633ms)
    Pending Position Management
      âœ” should store all investment parameters correctly (47602ms)
    XCM Caller Authorization (Test Mode)
      âœ” should allow calls in test mode regardless of caller (29902ms)

  XCMProxy Testnet - Position Execution

âœ… Connected to XCMProxy at: 0xf935e063b2108cc064bB356107ac01Dc90f96652
âœ… Network: moonbase
âœ… Operator: 0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
âœ… NFPM: 0xFAA10aBB2F3C0eE3c6c51C67bA870D08A5e457C3
âœ… Pool: 0x85a000207D69042E8B075fCe43B6F28dfCE228b2
âœ… Base Token: 0xdeb2336eA55d25B6286761CDdA17F5B5636cB84A
âœ… Quote Token: 0xb724cfB7eCee5b320A115230E0903de4d47dba7B

    Position Execution - Basic Flow
   âœ“ Pending position created
   âœ“ Position executed successfully
   âœ“ Local Position ID: 13
   âœ“ NFPM Token ID: 14
   âœ“ Liquidity: 1702119313100450221
   âœ“ Position counter incremented: 12 â†’ 13
      âœ” should execute pending position and mint NFPM position (41845ms)
      âœ” should fail on non-existent pending position (151ms)
      - should only allow operator to execute positions
    Position Execution - With Swaps
   âš ï¸  Swap execution requires live DEX pools
   âœ“ Swap logic is verified in local tests
      - should execute position with token swap if needed
    Position Execution - Edge Cases
   âœ“ Custom slippage stored: 3%
      âœ” should handle custom slippage parameters (6156ms)
   âœ“ Wide range stored: -500% to 500%
      âœ” should handle wide tick ranges (5618ms)
    Position Counter Management
   âœ“ Current position counter: 13
      âœ” should report increased counter after executions (60ms)

  XCMProxy Testnet - Liquidation

âœ… Connected to XCMProxy at: 0xf935e063b2108cc064bB356107ac01Dc90f96652
âœ… Network: moonbase
âœ… Operator: 0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
âœ… Pool: 0x85a000207D69042E8B075fCe43B6F28dfCE228b2
âœ… Base Token: 0xdeb2336eA55d25B6286761CDdA17F5B5636cB84A
âœ… Quote Token: 0xb724cfB7eCee5b320A115230E0903de4d47dba7B
âœ… Supported Tokens: 0xdeb2336eA55d25B6286761CDdA17F5B5636cB84A, 0xb724cfB7eCee5b320A115230E0903de4d47dba7B
âœ… Test Mode: Enabled (XCM calls will be skipped)

    Full Liquidation - Basic Flow
   âœ“ Test position created: 14
   âœ“ Position liquidated successfully
   âœ“ Position is now inactive
      âœ” should execute full liquidation of position (6090ms)
      âœ” should fail to liquidate non-existent position (150ms)
      âœ” should fail to liquidate already inactive position (102ms)
    Liquidate, Swap, and Return Flow
   âœ“ Full liquidation flow completed
   âœ“ Test mode: XCM transfer skipped
   âœ“ LiquidationCompleted event emitted
      âœ” should liquidate, swap proceeds, and return to Asset Hub (6195ms)
    Cancel Pending Position
   âœ“ Pending position cancelled
   âœ“ Assets returned to Asset Hub (test mode: skipped)
      âœ” should cancel pending position and return assets (42388ms)
      âœ” should fail to cancel non-existent pending position (84ms)
    Position Range Check
   âœ“ Position 1 out of range: false
   âœ“ Current tick: 115792089237316195423570985008687907853269984665640564039457584007913129639879
   âœ“ Position range: -6960 to 4080
      âœ” should check if position is out of range (140ms)
    Asset Return (Owner Function)
   âœ“ Manual asset return executed (test mode)
      âœ” should allow owner to manually return assets (35619ms)

  XCMProxy Testnet - Emergency & Admin Functions

âœ… Connected to XCMProxy at: 0xf935e063b2108cc064bB356107ac01Dc90f96652
âœ… Network: moonbase
âœ… Owner Account: 0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
âœ… Base Token: 0xdeb2336eA55d25B6286761CDdA17F5B5636cB84A
âœ… Quote Token: 0xb724cfB7eCee5b320A115230E0903de4d47dba7B
âœ… Pool ID: 0x85a000207D69042E8B075fCe43B6F28dfCE228b2
âœ… Supported Tokens (2): 0xdeb2336eA55d25B6286761CDdA17F5B5636cB84A, 0xb724cfB7eCee5b320A115230E0903de4d47dba7B
   Contract owner: 0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
   âœ… Test account has owner privileges

    Pause/Unpause Controls
   âœ“ Contract paused successfully
   âœ“ Contract unpaused for remaining tests
      âœ” should allow owner to pause contract (14490ms)
   âœ“ Operations blocked when paused
      âœ” should block operations when paused (42030ms)
    Test Mode Controls
   âœ“ Test mode toggled: true â†’ false
   âœ“ Test mode restored to: true
      âœ” should allow owner to toggle test mode (12339ms)
    Operator Management
   âœ“ Operator updated successfully
   âœ“ New operator: 0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
      âœ” should allow owner to update operator (12472ms)
    Integration Configuration
   Current NFPM: 0xFAA10aBB2F3C0eE3c6c51C67bA870D08A5e457C3
   âœ“ NFPM configuration is accessible
      âœ” should allow owner to update NFPM address (111ms)
   Current Quoter: 0x0fcf84e13e4551a12b6bfF7e3504e45C1a1CC1eF
   Current Router: 0x78d99c9EED0C6B31Ef961F5372b6f2000E7a912a
   âœ“ DEX integration configuration is accessible
      âœ” should allow owner to update DEX integrations (314ms)
    Slippage Configuration
   âœ“ Slippage updated: 100 â†’ 150 bps
   âœ“ Slippage restored to: 100 bps
      âœ” should allow owner to update default slippage (10677ms)
   âœ“ Excessive slippage rejected
      âœ” should reject slippage above 100% (169ms)
    Token Support Management
   âœ“ Token added to supported list
   âœ“ Token removed from supported list
      âœ” should allow owner to add supported token (11845ms)
    XCM Configuration Management
   XCM Config Frozen: false
   âœ“ XCM configuration can still be modified
      âœ” should check XCM configuration freeze status (215ms)
   âš ï¸  NOT freezing XCM config in tests
   This action is PERMANENT and cannot be reversed
   Use freezeXcmConfig() manually when ready for production
      âœ” should allow owner to freeze XCM config (PERMANENT) (344ms)
    Fee Collection
   âœ“ Fee collection callable
   Fees available: 0.000002398645125953 token0, 0.0 token1
      âœ” should allow collecting fees from position (124ms)
    Balance Queries
   Contract base token balance: 1004.134625711371114838
      âœ” should check contract token balances (48ms)
    Position Queries
   âœ“ Active positions: 6
   First position pool: 0x85a000207D69042E8B075fCe43B6F28dfCE228b2
   First position owner: 0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
   First position liquidity: 1701323543829447872
      âœ” should get active positions (103ms)
   âœ“ User positions: 15
   First position ID: 1
      âœ” should get user positions (70ms)
    Contract Health Summary

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
       XCMProxy Health Check Summary
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ›ï¸  Contract Status:
   Paused:          âœ… NO
   Test Mode:       âœ… ENABLED
   XCM Config:      ğŸ”“ Modifiable

ğŸ‘¥ Access Control:
   Owner:           0x2372cB955817cD5200a559c2faAC93d0B3a88f2d
   Operator:        0x2372cB955817cD5200a559c2faAC93d0B3a88f2d

ğŸ”— DEX Integrations:
   NFPM:            âœ… 0xFAA10aBB2F3C0eE3c6c51C67bA870D08A5e457C3
   Quoter:          âœ… 0x0fcf84e13e4551a12b6bfF7e3504e45C1a1CC1eF
   Router:          âœ… 0x78d99c9EED0C6B31Ef961F5372b6f2000E7a912a

ğŸŒ‰ XCM Configuration:
   XTokens:         âœ… 0x0000000000000000000000000000000000000804
   Asset Hub ID:    âœ… 1000

âš™ï¸  Operating Parameters:
   Default Slippage: 100 bps (1.00%)

ğŸ“Š Position Statistics:
   Total Created:    15
   Currently Active: 6

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… CONTRACT READY FOR TESTNET OPERATIONS

      âœ” should display comprehensive health check (1042ms)


  54 passing (7m)
  2 pending

