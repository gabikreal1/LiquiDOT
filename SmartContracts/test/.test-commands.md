# Test Commands Cheat Sheet

Quick reference for running LiquiDOT tests.

## Prerequisites

```powershell
# Set AssetHubVault address (required for all testnet tests)
$env:ASSETHUB_CONTRACT="0xYourAddress"

# Set XCMProxy address (required for integration tests)
$env:XCMPROXY_CONTRACT="0xYourAddress"
```

## AssetHubVault Tests

```powershell
# Configuration check (safe, read-only)
npx hardhat test test/AssetHubVault/testnet/1.config-check.test.js --network passethub

# Deposits and withdrawals
npx hardhat test test/AssetHubVault/testnet/2.deposits.test.js --network passethub

# Investment flow (test mode, no real XCM)
npx hardhat test test/AssetHubVault/testnet/3.investment.test.js --network passethub

# Liquidation flow (test mode, no real XCM)
npx hardhat test test/AssetHubVault/testnet/4.liquidation.test.js --network passethub

# Emergency functions
npx hardhat test test/AssetHubVault/testnet/5.emergency.test.js --network passethub

# Run all AssetHubVault tests
npx hardhat test test/AssetHubVault/testnet/**/*.test.js --network passethub
```

## Integration Tests

```powershell
# Guided investment flow (includes manual steps)
npx hardhat test test/Integration/testnet/1.guided-investment-flow.test.js --network passethub
```

## XCMProxy Tests (Moonbase)

```powershell
# Configuration check
npx hardhat test test/XCMProxy/testnet/1.config-check.test.js --network moonbase

# Receive assets from AssetHub
npx hardhat test test/XCMProxy/testnet/2.receive-assets.test.js --network moonbase

# Execute position trades
npx hardhat test test/XCMProxy/testnet/3.execute-position.test.js --network moonbase

# Liquidation flow
npx hardhat test test/XCMProxy/testnet/4.liquidation.test.js --network moonbase

# Emergency functions
npx hardhat test test/XCMProxy/testnet/5.emergency.test.js --network moonbase

# Run all XCMProxy tests
npx hardhat test test/XCMProxy/testnet/**/*.test.js --network moonbase
```

## Test File Organization

```
test/
├── AssetHubVault/testnet/
│   ├── 1.config-check.test.js        # Verify deployment
│   ├── 2.deposits.test.js            # Deposit/withdrawal behavior
│   ├── 3.investment.test.js          # Investment dispatch (test mode)
│   ├── 4.liquidation.test.js         # Liquidation settlement
│   └── 5.emergency.test.js           # Emergency controls
│
├── Integration/testnet/
│   └── 1.guided-investment-flow.test.js  # End-to-end flow with manual XCM steps
│
├── XCMProxy/testnet/
│   ├── 1.config-check.test.js        # Verify deployment
│   ├── 2.receive-assets.test.js      # XCM asset reception
│   ├── 3.execute-position.test.js    # Position trades
│   ├── 4.liquidation.test.js         # Liquidation flow
│   └── 5.emergency.test.js           # Emergency controls
│
├── helpers/
│   ├── deploy-algebra-suite.js       # Algebra DEX deployment utilities
│   ├── deploy-xcm-proxy.js           # XCMProxy deployment utilities
│   ├── deploy-test-contracts.js      # Test contract helpers
│   └── test-environment.js           # Test environment setup
│
└── README.md                          # Main documentation
```

## Common Test Scenarios

### Just Deployed AssetHubVault?

```powershell
$env:ASSETHUB_CONTRACT="0xNewAddress"
npx hardhat test test/AssetHubVault/testnet/1.config-check.test.js --network passethub
```

### Ready to Test Deposits?

```powershell
npx hardhat test test/AssetHubVault/testnet/2.deposits.test.js --network passethub
```

### Testing Investment Flow?

```powershell
npx hardhat test test/AssetHubVault/testnet/3.investment.test.js --network passethub
npx hardhat test test/Integration/testnet/1.guided-investment-flow.test.js --network passethub
```

### XCM Proxy Deployed on Moonbase?

```powershell
$env:XCMPROXY_CONTRACT="0xYourProxyAddress"
npx hardhat test test/XCMProxy/testnet/1.config-check.test.js --network moonbase
```

## Tips

- Tests are numbered 1-5, run in order for logical flow
- All testnet tests work with existing deployed contracts
- Tests don't assume clean state (idempotent design)
- Use `--network passethub` for Asset Hub tests
- Use `--network moonbase` for Moonbase/XCMProxy tests
- Check `README.md` for detailed guidance
